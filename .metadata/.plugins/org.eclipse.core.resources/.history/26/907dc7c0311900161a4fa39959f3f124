package firstPackage;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
	
public class Main {
	
	public static void main(String[] args) {
		try {
		    Class.forName( "oracle.jdbc.OracleDriver" );
		    getConnection();
		} catch ( ClassNotFoundException e ) {
		    e.printStackTrace();
		    
		}
	}
	
	public static void getConnection() {
		String url = "jdbc:oracle:thin:[tbeclin/tbeclin]@dbisep.isep.fr:1521:ORCL";
		String user = "tbeclin";
		String pass = "tbeclin";
		Connection connexion = null;
		try {
		    connexion = DriverManager.getConnection( url, user, pass );
		    System.out.println("Bdd Connected");
		    displayDepartment(connexion);
		} catch ( SQLException e ) {
			e.printStackTrace();
		} finally {
		    if ( connexion != null )
		        try {
		            connexion.close();
		        } catch ( SQLException ignore ) {
		        	ignore.printStackTrace();
		        }
		}
	}
	
	public static void displayDepartment(Connection connexion) throws SQLException {
		Statement statement = connexion.createStatement();
		ResultSet resultat = statement.executeQuery( "SELECT deptno, dname, loc FROM dept" );
		
		while ( resultat.next() ) {
			int deptno = resultat.getInt( "deptno");
			String dname = resultat.getString( "dname" );
			String loc = resultat.getString("loc");
			
			System.out.println("Department " + deptno + " is for " 
					+ dname + " and located in " + loc);
		}
		resultat.close();
	}
}
